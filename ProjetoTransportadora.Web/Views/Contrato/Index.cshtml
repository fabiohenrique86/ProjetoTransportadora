@using ProjetoTransportadora.Dto;

@{
    ViewBag.Title = "Contratos";

    UsuarioDto usuarioDto = null;
    if (Session[System.Configuration.ConfigurationManager.AppSettings["ProjetoTransportadora.Usuario"]] != null)
    {
        usuarioDto = (UsuarioDto)Session[System.Configuration.ConfigurationManager.AppSettings["ProjetoTransportadora.Usuario"]];
    }
}

@section styles
{
    <style type="text/css">
        .modal-lg {
            width: 85%;
        }

        .modal-md {
            width: 70%;
        }

        .modal-body {
            padding: 40px;
        }

        .ui-autocomplete {
            z-index: 2147483647;
        }
    </style>
}

@section scripts
{
    <script type="text/javascript">

        function carregarModalNovo() {
            $("#lblAcao").html("Novo");
            $("#lblTitulo").html("");
            $("#btnIncluir").show();
            $("#btnAlterar").hide();

            limparFormulario();
            habilitarModal(true);

            $("#valorParcela").prop("disabled", "disabled");
            $("#valorFinanciado").prop("disabled", "disabled");

            //$("#taxaMulta").val();
            //$("#taxaMora").val();

            $("#modalContrato").modal('show');
            $('#dados-tab').click();
        }

        function carregarModalBaixar(data, o) {
            $("#lblTituloBaixar").text(data.Id);
            $("#contratoIdBaixar").val(data.Id);
            $("#modalContratoBaixar").modal('show');
        }

        function limparModalAntecipar() {
            $("#dataAntecipacao").val("");
            $("#valorSaldoAntecipacao").val("");
            $("#valorAntecipacao").val("");
        }

        function carregarModalAntecipar(idContrato) {

            limparModalAntecipar();

            var contratoParcelaDto = {};

            contratoParcelaDto.IdContrato = idContrato;

            $.ajax({
                dataType: "json",
                type: "GET",
                url: "/ContratoParcela/Listar",
                data: contratoParcelaDto,
                contentType: "application/json",
                success: function (data) {

                    if (!data.Sucesso) {
                        alert(data.Erro ? "danger" : "warning", data.Mensagem);
                        return;
                    }

                    var valorSaldoAntecipacao = 0;
                    for (var i = 0; i < data.Data.length; i++) {
                        valorSaldoAntecipacao += data.Data[i].ValorParcela;
                    }

                    $("#lblTituloAntecipar").text(idContrato);
                    $("#contratoIdAntecipar").val(idContrato);
                    $("#valorSaldoAntecipacao").val(Globalize.format(valorSaldoAntecipacao, "n2"));
                    $("#valorAntecipacao").val(Globalize.format(valorSaldoAntecipacao, "n2"));

                    $("#modalContratoAntecipar").modal('show');
                }
            });

        }

        function habilitarModal(opcao) {
            if (opcao) {
                $("#modalContrato input, #modalContrato select, #modalContrato textarea").removeProp("disabled");
                $("i.glyphicon-remove").show();
            }
            else {
                $("#modalContrato input, #modalContrato select, #modalContrato textarea").prop("disabled", "disabled");
                $("i.glyphicon-remove").hide();
            }
        }

        function limparFormulario() {

            $("#frmContrato").trigger("reset");

            $("#idContrato").val("");
            $("#idProprietarioAnterior").val("");
            $("#idProprietarioAtual").val("");

            $("#tbContratoParcela").DataTable().clear().draw();
            $("#tbContratoHistorico").DataTable().clear().draw();
        }

        function calcularValorFinanciado() {

            var valorVeiculo = Globalize.parseFloat($("#valorVeiculo").val());
            if (isNaN(valorVeiculo))
                valorVeiculo = 0;

            var valorEntrada = Globalize.parseFloat($("#valorEntrada").val());
            if (isNaN(valorEntrada))
                valorEntrada = 0;

            var valorDocumentacao = Globalize.parseFloat($("#valorDocumentacao").val());
            if (isNaN(valorDocumentacao))
                valorDocumentacao = 0;

            var valorTarifa = Globalize.parseFloat($("#valorTarifa").val());
            if (isNaN(valorTarifa))
                valorTarifa = 0;

            var valorVeiculoEntrada = Globalize.parseFloat($("#valorVeiculoEntrada").val());
            if (isNaN(valorVeiculoEntrada))
                valorVeiculoEntrada = 0;

            var valorDesconto = Globalize.parseFloat($("#valorDesconto").val());
            if (isNaN(valorDesconto))
                valorDesconto = 0;

            var valorDepositado = Globalize.parseFloat($("#valorDepositado").val());
            if (isNaN(valorDepositado))
                valorDepositado = 0;

            var valorDinheiro = Globalize.parseFloat($("#valorDinheiro").val());
            if (isNaN(valorDinheiro))
                valorDinheiro = 0;

            var valorFinanciado = valorVeiculo - valorEntrada + valorDocumentacao - valorDesconto + valorTarifa - valorVeiculoEntrada - valorDinheiro - valorDepositado;

            $("#valorFinanciado").val(Globalize.format(valorFinanciado, "n2"));
        }

        function carregarDadosModal(data) {

            // aba - dados

            $("#dataContrato").val(moment(data.DataContrato).format("DD/MM/YYYY"));

            $("#cliente").val(data.PessoaClienteDto.Nome);
            $("#idCliente").val(data.PessoaClienteDto.Id);

            $("#produto").val(data.IdProduto);

            if (data.VeiculoDto != null)
            {
                $("#veiculo").val(data.VeiculoDto.MontadoraDto.Nome + " - " + data.VeiculoDto.Modelo + " - " + data.VeiculoDto.Placa);
                $("#idVeiculo").val(data.VeiculoDto.Id);
            }

            if (data.PessoaFiadorDto != null)
            {
                $("#fiador").val(data.PessoaFiadorDto.Nome);
                $("#idFiador").val(data.PessoaFiadorDto.Id);
            }

            if (data.PessoaIndicacaoDto != null)
            {
                $("#indicacao").val(data.PessoaIndicacaoDto.Nome);
                $("#idIndicacao").val(data.PessoaIndicacaoDto.Id);
            }

            if (data.PessoaPromotorDto != null)
            {
                $("#promotor").val(data.PessoaPromotorDto.Nome);
                $("#idPromotor").val(data.PessoaPromotorDto.Id);
            }

            $("#canal").val(data.IdCanal);

            $("#dataPrimeiraParcela").val(moment(data.DataPrimeiraParcela).format("DD/MM/YYYY"));
            $("#valorParcela").val(Globalize.format(data.ContratoParcelaDto[0].ValorParcela, "n2"));
            $("#taxaMulta").val(Globalize.format(data.TaxaMulta, "n2"));
            $("#taxaMora").val(Globalize.format(data.TaxaMora, "n2"));

            if (data.DataAntecipacao != null)
                $("#dataAntecipacaoDados").val(moment(data.DataAntecipacao).format("DD/MM/YYYY"));

            $("#valorAntecipacaoDados").val(Globalize.format(data.ValorAntecipacao, "n2"));

            if (data.DataBaixa != null)
                $("#dataBaixaDados").val(moment(data.DataBaixa).format("DD/MM/YYYY"));

            // aba - valores

            $("#valorVeiculo").val(Globalize.format(data.ValorVeiculo, "n2"));
            $("#valorEntrada").val(Globalize.format(data.ValorEntrada, "n2"));
            $("#valorDocumentacao").val(Globalize.format(data.ValorDocumentacao, "n2"));
            $("#valorDesconto").val(Globalize.format(data.ValorDesconto, "n2"));
            $("#valorDinheiro").val(Globalize.format(data.ValorDinheiro, "n2"));

            if (data.VeiculoEntradaDto != null)
            {
                $("#veiculoEntrada").val(data.VeiculoEntradaDto.MontadoraDto.Nome + " - " + data.VeiculoEntradaDto.Modelo + " - " + data.VeiculoEntradaDto.Placa);
                $("#idVeiculoEntrada").val(data.VeiculoEntradaDto.Id);
            }

            $("#valorVeiculoEntrada").val(Globalize.format(data.ValorVeiculoEntrada, "n2"));

            $("#valorDepositado").val(Globalize.format(data.ValorDepositado, "n2"));
            $("#valorTarifa").val(Globalize.format(data.ValorTarifa, "n2"));
            $("#valorFinanciado").val(Globalize.format(data.ValorFinanciado, "n2"));
            $("#taxaJuros").val(Globalize.format(data.TaxaJuros, "n2"));
            $("#quantidadeParcela").val(data.ContratoParcelaDto.length);
            $("#valorFinanciadoDocumentacao").val(Globalize.format(data.ValorFinanciadoDocumentacao, "n2"));
            $("#valorFinanciadoVeiculo").val(Globalize.format(data.ValorFinanciadoVeiculo, "n2"));

            // aba - parcelas
            $("#tbContratoParcela").DataTable().clear();
            $("#tbContratoParcela").DataTable().rows.add(data.ContratoParcelaDto).draw();

            // aba - histórico
            //$("#tbContratoHistorico").DataTable().clear();
            //$("#tbContratoHistorico").DataTable().rows.add(data.ContratoHistoricoDto).draw();

            $("#tbContratoHistorico").DataTable().clear().draw();
            $(data.ContratoHistoricoDto).each(function (i, o) {

                $("#tbContratoHistorico").DataTable().rows.add([
                {
                    "Id": o.Id,
                    "DataHistorico": "<input type='text' class='form-control data datepicker text-center dataHistorico' value='" + moment(o.DataHistorico).format("DD/MM/YYYY") + "' />",
                    "Descricao": "<textarea class='form-control descricaoHistorico' rows='3'>" + o.Descricao + "</textarea>",
                    "Acao": "<i class='glyphicon glyphicon-remove' title='Excluir' style='cursor: pointer'></i>"
                }]).draw();
            });

            // reaplica máscaras
            $(".valorMulta").mask("000.000.000,00", { reverse: true });

            $(".dataMulta").mask("00/00/0000");
            $(".dataMulta").datepicker({
                dateFormat: 'dd/mm/yy',
                dayNames: ['Domingo', 'Segunda', 'Terça', 'Quarta', 'Quinta', 'Sexta', 'Sábado'],
                dayNamesMin: ['D', 'S', 'T', 'Q', 'Q', 'S', 'S', 'D'],
                dayNamesShort: ['Dom', 'Seg', 'Ter', 'Qua', 'Qui', 'Sex', 'Sáb', 'Dom'],
                monthNames: ['Janeiro', 'Fevereiro', 'Março', 'Abril', 'Maio', 'Junho', 'Julho', 'Agosto', 'Setembro', 'Outubro', 'Novembro', 'Dezembro'],
                monthNamesShort: ['Jan', 'Fev', 'Mar', 'Abr', 'Mai', 'Jun', 'Jul', 'Ago', 'Set', 'Out', 'Nov', 'Dez'],
                nextText: 'Próximo',
                prevText: 'Anterior',
                changeMonth: true,
                changeYear: true
            });

            $(".dataVencimentoMulta").mask("00/00/0000");
            $(".dataVencimentoMulta").datepicker({
                dateFormat: 'dd/mm/yy',
                dayNames: ['Domingo', 'Segunda', 'Terça', 'Quarta', 'Quinta', 'Sexta', 'Sábado'],
                dayNamesMin: ['D', 'S', 'T', 'Q', 'Q', 'S', 'S', 'D'],
                dayNamesShort: ['Dom', 'Seg', 'Ter', 'Qua', 'Qui', 'Sex', 'Sáb', 'Dom'],
                monthNames: ['Janeiro', 'Fevereiro', 'Março', 'Abril', 'Maio', 'Junho', 'Julho', 'Agosto', 'Setembro', 'Outubro', 'Novembro', 'Dezembro'],
                monthNamesShort: ['Jan', 'Fev', 'Mar', 'Abr', 'Mai', 'Jun', 'Jul', 'Ago', 'Set', 'Out', 'Nov', 'Dez'],
                nextText: 'Próximo',
                prevText: 'Anterior',
                changeMonth: true,
                changeYear: true
            });
        }

        function consultar(id)
        {
            var contratoDto = { Id: id };

            $.ajax({
                dataType: "json",
                type: "POST",
                url: "/Contrato/Listar",
                data: JSON.stringify(contratoDto),
                contentType: "application/json",
                success: function (data) {

                    if (!data.Sucesso) {
                        alert(data.Erro ? "danger" : "warning", data.Mensagem);
                        return;
                    }

                    limparFormulario();
                    carregarDadosModal(data.Data[0]);
                    habilitarModal(false);

                    $("#lblAcao").text("Consultar");
                    $("#lblTitulo").text(id);

                    $("#idContrato").val("");
                    $("#btnIncluir").hide();
                    $("#btnAlterar").hide();
                    $("#divDataAntecipacaoDados").show();
                    $("#divValorAntecipacaoDados").show();
                    $("#divDataBaixaDados").show();

                    $("#modalContrato").modal('show');
                    $('#dados-tab').click();
                }
            });

        }

        function alterar(id)
        {
            var contratoDto = { Id: id };

            $.ajax({
                dataType: "json",
                type: "POST",
                url: "/Contrato/Listar",
                data: JSON.stringify(contratoDto),
                contentType: "application/json",
                success: function (data) {

                    if (!data.Sucesso) {
                        alert(data.Erro ? "danger" : "warning", data.Mensagem);
                        return;
                    }

                    limparFormulario();
                    carregarDadosModal(data.Data[0]);
                    habilitarModal(true);

                    $("#idContrato").val(id);
                    $("#lblAcao").text("Alterar");

                    $("#lblTitulo").text(id);
                    $("#btnIncluir").hide();
                    $("#btnAlterar").show();
                    $("#divDataAntecipacaoDados").hide();
                    $("#divValorAntecipacaoDados").hide();
                    $("#divDataBaixaDados").hide();

                    $("#modalContrato").modal('show');
                    $('#dados-tab').click();
                }
            });


        }

        $(document).ready(function () {

            var tbContrato = $("#tbContrato").DataTable({
                "ordering": false,
                "bFilter": false,
                "paging": false,
                "paging": true,
                "pageLength": 25,
                "info": false,
                "searching": false,
                "language": {
                    "lengthMenu": "_MENU_ registros por página",
                    "zeroRecords": "Sem registros a serem exibidos",
                    "info": "Página _PAGE_ de _PAGES_",
                    "infoEmpty": "Sem registros a serem exibidos",
                    "infoFiltered": "(filtrados de _MAX_ total de registros)",
                    "sSearch": "Pesquisar",
                    "oPaginate": { "sNext": "Próximo", "sPrevious": "Anterior", "sFirst": "Primeiro", "sLast": "Último" }
                },
                "columns":
                    [
                        { "data": "Id", "className": "text-center" },
                        { "data": "NomeCliente", "className": "text-center" },
                        { "data": "PlacaVeiculo", "className": "text-center" },
                        { "data": "ModeloVeiculo", "className": "text-center" },
                        { "data": function (data, type, row) { return data["DataContrato"] != null ? moment(data["DataContrato"]).format("DD/MM/YYYY") : "" }, "className": "text-center" },
                        { "data": function (data, type, row) { return data["ValorFinanciado"] != null ? Globalize.format(data.ValorFinanciado, "n2") : "" }, "className": "text-center" },
                        { "data": "NomeSituacaoContrato", "className": "text-center" },
                        {
                            "data": function (data, type, row) {

                                var consultar = "<i class='glyphicon glyphicon-search' title='Consultar' style='cursor: pointer' onclick='consultar(" + data.Id + ")'></i>";
                                var alterar = "<i class='glyphicon glyphicon-edit' title='Editar' style='cursor: pointer' onclick='alterar(" + data.Id + ")'></i>";
                                var antecipar = "<i class='glyphicon glyphicon-play' title='Antecipar' style='cursor: pointer' onclick='carregarModalAntecipar(" + data.Id + ")'></i>";
                                var baixar = "<i class='glyphicon glyphicon-ok' title='Baixar' style='cursor: pointer' onclick='carregarModalBaixar(" + JSON.stringify(data) + ", this)'></i>";

                                if (data.IdSituacaoContrato == '@SituacaoContratoDto.EnumSituacaoContrato.Ativo.GetHashCode()')
                                    return consultar + " " + alterar + " " + antecipar + " " + baixar;
                                else
                                    return consultar + " " + alterar;

                            }, "className": "text-center"
                        }
                    ]
            });

            var tbSituacaoContratoResumo = $("#tbSituacaoContratoResumo").DataTable({
                "ordering": false,
                "bFilter": false,
                "paging": false,
                "ordering": false,
                "info": false,
                "searching": false,
                "autoWidth": false,
                "language": {
                    "lengthMenu": "_MENU_ registros por página",
                    "zeroRecords": "Sem registros a serem exibidos",
                    "info": "Página _PAGE_ de _PAGES_",
                    "infoEmpty": "Sem registros a serem exibidos",
                    "infoFiltered": "(filtrados de _MAX_ total de registros)",
                    "sSearch": "Pesquisar",
                    "oPaginate": { "sNext": "Próximo", "sPrevious": "Anterior", "sFirst": "Primeiro", "sLast": "Último" }
                },
                "columns":
                    [
                        { "data": "SituacaoContrato", "className": "text-center", "width": "20%" },
                        { "data": "Produto", "className": "text-center", "width": "20%" },
                        { "data": "Quantidade", "className": "text-center", "width": "20%" },
                        { "data": function (data, type, row) { return data["ValorEntrada"] != null ? Globalize.format(data.ValorEntrada, "n2") : "" }, "className": "text-center", "width": "20%" },
                        { "data": function (data, type, row) { return data["ValorFinanciado"] != null ? Globalize.format(data.ValorFinanciado, "n2") : "" }, "className": "text-center", "width": "20%" }
                    ]
            });

            var tbSituacaoParcelaResumo = $("#tbSituacaoParcelaResumo").DataTable({
                "ordering": false,
                "bFilter": false,
                "paging": false,
                "ordering": false,
                "info": false,
                "searching": false,
                "autoWidth": false,
                "language": {
                    "lengthMenu": "_MENU_ registros por página",
                    "zeroRecords": "Sem registros a serem exibidos",
                    "info": "Página _PAGE_ de _PAGES_",
                    "infoEmpty": "Sem registros a serem exibidos",
                    "infoFiltered": "(filtrados de _MAX_ total de registros)",
                    "sSearch": "Pesquisar",
                    "oPaginate": { "sNext": "Próximo", "sPrevious": "Anterior", "sFirst": "Primeiro", "sLast": "Último" }
                },
                "columns":
                    [
                        { "data": "SituacaoParcela", "className": "text-center", "width": "25%" },
                        { "data": "Quantidade", "className": "text-center", "width": "25%" },
                        { "data": function (data, type, row) { return data["ValorJuros"] != null ? Globalize.format(data.ValorJuros, "n2") : "" }, "className": "text-center", "width": "25%" },
                        { "data": function (data, type, row) { return data["ValorParcela"] != null ? Globalize.format(data.ValorParcela, "n2") : "" }, "className": "text-center", "width": "25%" }
                    ]
            });

            var tbContratoParcela = $("#tbContratoParcela").DataTable({
                "ordering": false,
                "bFilter": false,
                "paging": false,
                "ordering": false,
                "info": false,
                "searching": false,
                "language": {
                    "lengthMenu": "_MENU_ registros por página",
                    "zeroRecords": "Sem registros a serem exibidos",
                    "info": "Página _PAGE_ de _PAGES_",
                    "infoEmpty": "Sem registros a serem exibidos",
                    "infoFiltered": "(filtrados de _MAX_ total de registros)",
                    "sSearch": "Pesquisar",
                    "oPaginate": { "sNext": "Próximo", "sPrevious": "Anterior", "sFirst": "Primeiro", "sLast": "Último" }
                },
                "columns":
                    [
                        { "data": "NumeroParcela", "className": "text-center" },
                        { "data": function (data, type, row) { return data["DataInicio"] != null ? moment(data["DataInicio"]).format("DD/MM/YYYY") : "" }, "className": "text-center" },
                        { "data": function (data, type, row) { return data["DataVencimento"] != null ? moment(data["DataVencimento"]).format("DD/MM/YYYY") : "" }, "className": "text-center" },
                        { "data": "DiasContrato", "className": "text-center" },
                        { "data": "DiasParcela", "className": "text-center" },
                        { "data": function (data, type, row) { return data["DataPagamento"] != null ? moment(data["DataPagamento"]).format("DD/MM/YYYY") : "" }, "className": "text-center" },
                        { "data": function (data, type, row) { return data["DataEmissao"] != null ? moment(data["DataEmissao"]).format("DD/MM/YYYY") : "" }, "className": "text-center" },
                        { "data": function (data, type, row) { return data["ValorOriginal"] != null ? Globalize.format(data.ValorOriginal, "n2") : "" }, "className": "text-center" },
                        { "data": function (data, type, row) { return data["ValorAmortizacao"] != null ? Globalize.format(data.ValorAmortizacao, "n2") : "" }, "className": "text-center" },
                        { "data": function (data, type, row) { return data["ValorJuros"] != null ? Globalize.format(data.ValorJuros, "n2") : "" }, "className": "text-center" },
                        { "data": function (data, type, row) { return data["ValorMulta"] != null ? Globalize.format(data.ValorMulta, "n2") : "" }, "className": "text-center" },
                        { "data": function (data, type, row) { return data["ValorMora"] != null ? Globalize.format(data.ValorMora, "n2") : "" }, "className": "text-center" },
                        { "data": function (data, type, row) { return data["ValorDesconto"] != null ? Globalize.format(data.ValorDesconto, "n2") : "" }, "className": "text-center" },
                        { "data": function (data, type, row) { return data["ValorParcela"] != null ? Globalize.format(data.ValorParcela, "n2") : "" }, "className": "text-center" },
                        { "data": "SituacaoParcelaDto.Nome", "className": "text-center" }
                    ]
            });

            var tbContratoHistorico = $("#tbContratoHistorico").DataTable({
                "ordering": false,
                "bFilter": false,
                "paging": false,
                "ordering": false,
                "info": false,
                "searching": false,
                "autoWidth": false,
                "language": {
                    "lengthMenu": "_MENU_ registros por página",
                    "zeroRecords": "Sem registros a serem exibidos",
                    "info": "Página _PAGE_ de _PAGES_",
                    "infoEmpty": "Sem registros a serem exibidos",
                    "infoFiltered": "(filtrados de _MAX_ total de registros)",
                    "sSearch": "Pesquisar",
                    "oPaginate": { "sNext": "Próximo", "sPrevious": "Anterior", "sFirst": "Primeiro", "sLast": "Último" }
                },
                "columns":
                    [
                        { "data": "Id", "className": "text-center", "visible": false, "width": "5%" },
                        { "data": "DataHistorico", "className": "text-center", "width": "5%" },
                        { "data": "Descricao", "className": "text-center", "width": "85%" },
                        { "data": "Acao", "className": "text-center", "width": "5%" }
                    ]
            });

            // botão excluir tbContratoHistorico
            $('#tbContratoHistorico tbody').on('click', 'i.glyphicon-remove', function () {
                if (confirm("Deseja realmente excluir o histórico?")) {
                    tbContratoHistorico.row($(this).parents('tr')).remove().draw();
                }
            });

            $("#clientePesquisar").autocomplete({
                minLength: 3,
                source: function (request, response) {
                    var nome = null;
                    var cpf = null;
                    var cnpj = null;
                    var numero = parseInt(request.term);

                    if (isNaN(numero))
                        nome = request.term;
                    else {
                        cpf = request.term;
                        cnpj = request.term;
                    }

                    $.getJSON("/PessoaJuridica/ListarAutoComplete", { Nome: nome, Cpf: cpf, Cnpj: cnpj, Ativo: true }, function (data, status, xhr) {
                        // se não houver pessoa cadastrada, retorna mensagem ao usuário
                        if (data == null || data.Data.length <= 0) {
                            data.Data.push({ Id: 0, Nome: "Pessoa não cadastrada", Cpf: null, Cnpj: null });
                        }
                        response($.map(data.Data, function (pessoa) {
                            if (pessoa.Cpf == null && pessoa.Cnpj == null)
                                return { label: pessoa.Nome, value: pessoa.Id }
                            else if (pessoa.Cpf != null)
                                return { label: pessoa.Nome + " (" + formatarCpf(pessoa.Cpf) + ")", value: pessoa.Id }
                            else if (pessoa.Cnpj != null)
                                return { label: pessoa.Nome + " (" + formatarCnpj(pessoa.Cnpj) + ")", value: pessoa.Id }
                        }));
                    });
                },
                select: function (event, ui) {
                    // apaga a pesquisa do cliente selecionado
                    if (ui.item.label == "Pessoa não cadastrada") {
                        ui.item.label = "";
                        ui.item.value = "";
                        return;
                    }
                    $("#idClientePesquisar").val(ui.item.value);
                    ui.item.label = ui.item.label;
                    ui.item.value = ui.item.label;
                },
                change: function (event, ui)
                {
                    if (ui == null || ui.item == undefined || ui.item == null) {
                        $("#clientePesquisar").val("");
                        $("#idClientePesquisar").val("");
                    }
                }
            });

            $("#cliente").autocomplete({
                minLength: 3,
                source: function (request, response) {
                    var nome = null;
                    var cpf = null;
                    var cnpj = null;
                    var numero = parseInt(request.term);

                    if (isNaN(numero))
                        nome = request.term;
                    else {
                        cpf = request.term;
                        cnpj = request.term;
                    }

                    $.getJSON("/PessoaJuridica/ListarAutoComplete", { Nome: nome, Cpf: cpf, Cnpj: cnpj, Ativo: true }, function (data, status, xhr) {
                        // se não houver pessoa cadastrada, retorna mensagem ao usuário
                        if (data == null || data.Data.length <= 0) {
                            data.Data.push({ Id: 0, Nome: "Pessoa não cadastrada", Cpf: null, Cnpj: null });
                        }
                        response($.map(data.Data, function (pessoa) {
                            if (pessoa.Cpf == null && pessoa.Cnpj == null)
                                return { label: pessoa.Nome, value: pessoa.Id }
                            else if (pessoa.Cpf != null)
                                return { label: pessoa.Nome + " (" + formatarCpf(pessoa.Cpf) + ")", value: pessoa.Id }
                            else if (pessoa.Cnpj != null)
                                return { label: pessoa.Nome + " (" + formatarCnpj(pessoa.Cnpj) + ")", value: pessoa.Id }
                        }));
                    });
                },
                select: function (event, ui) {
                    // apaga a pesquisa do cliente selecionado
                    if (ui.item.label == "Pessoa não cadastrada") {
                        ui.item.label = "";
                        ui.item.value = "";
                        return;
                    }
                    $("#idCliente").val(ui.item.value);
                    ui.item.label = ui.item.label;
                    ui.item.value = ui.item.label;
                },
                change: function (event, ui) {
                    if (ui == null || ui.item == undefined || ui.item == null) {
                        $("#cliente").val("");
                        $("#idCliente").val("");
                    }
                }
            });

            $("#fiador").autocomplete({
                minLength: 3,
                source: function (request, response) {
                    var nome = null;
                    var cpf = null;
                    var cnpj = null;
                    var numero = parseInt(request.term);

                    if (isNaN(numero))
                        nome = request.term;
                    else {
                        cpf = request.term;
                        cnpj = request.term;
                    }

                    $.getJSON("/PessoaJuridica/ListarAutoComplete", { Nome: nome, Cpf: cpf, Cnpj: cnpj, Ativo: true }, function (data, status, xhr) {
                        // se não houver pessoa cadastrada, retorna mensagem ao usuário
                        if (data == null || data.Data.length <= 0) {
                            data.Data.push({ Id: 0, Nome: "Pessoa não cadastrada", Cpf: null, Cnpj: null });
                        }
                        response($.map(data.Data, function (pessoa) {
                            if (pessoa.Cpf == null && pessoa.Cnpj == null)
                                return { label: pessoa.Nome, value: pessoa.Id }
                            else if (pessoa.Cpf != null)
                                return { label: pessoa.Nome + " (" + formatarCpf(pessoa.Cpf) + ")", value: pessoa.Id }
                            else if (pessoa.Cnpj != null)
                                return { label: pessoa.Nome + " (" + formatarCnpj(pessoa.Cnpj) + ")", value: pessoa.Id }
                        }));
                    });
                },
                select: function (event, ui) {
                    // apaga a pesquisa do cliente selecionado
                    if (ui.item.label == "Pessoa não cadastrada") {
                        ui.item.label = "";
                        ui.item.value = "";
                        return;
                    }
                    $("#idFiador").val(ui.item.value);
                    ui.item.label = ui.item.label;
                    ui.item.value = ui.item.label;
                },
                change: function (event, ui) {
                    if (ui == null || ui.item == undefined || ui.item == null) {
                        $("#fiador").val("");
                        $("#idFiador").val("");
                    }
                }
            });

            $("#indicacao").autocomplete({
                minLength: 3,
                source: function (request, response) {
                    var nome = null;
                    var cpf = null;
                    var cnpj = null;
                    var numero = parseInt(request.term);

                    if (isNaN(numero))
                        nome = request.term;
                    else {
                        cpf = request.term;
                        cnpj = request.term;
                    }

                    $.getJSON("/PessoaJuridica/ListarAutoComplete", { Nome: nome, Cpf: cpf, Cnpj: cnpj, Ativo: true }, function (data, status, xhr) {
                        // se não houver pessoa cadastrada, retorna mensagem ao usuário
                        if (data == null || data.Data.length <= 0) {
                            data.Data.push({ Id: 0, Nome: "Pessoa não cadastrada", Cpf: null, Cnpj: null });
                        }
                        response($.map(data.Data, function (pessoa) {
                            if (pessoa.Cpf == null && pessoa.Cnpj == null)
                                return { label: pessoa.Nome, value: pessoa.Id }
                            else if (pessoa.Cpf != null)
                                return { label: pessoa.Nome + " (" + formatarCpf(pessoa.Cpf) + ")", value: pessoa.Id }
                            else if (pessoa.Cnpj != null)
                                return { label: pessoa.Nome + " (" + formatarCnpj(pessoa.Cnpj) + ")", value: pessoa.Id }
                        }));
                    });
                },
                select: function (event, ui) {
                    // apaga a pesquisa do cliente selecionado
                    if (ui.item.label == "Pessoa não cadastrada") {
                        ui.item.label = "";
                        ui.item.value = "";
                        return;
                    }
                    $("#idIndicacao").val(ui.item.value);
                    ui.item.label = ui.item.label;
                    ui.item.value = ui.item.label;
                },
                change: function (event, ui) {
                    if (ui == null || ui.item == undefined || ui.item == null) {
                        $("#indicacao").val("");
                        $("#idIndicacao").val("");
                    }
                }
            });

            $("#promotor").autocomplete({
                minLength: 3,
                source: function (request, response) {
                    var nome = null;
                    var cpf = null;
                    var cnpj = null;
                    var numero = parseInt(request.term);

                    if (isNaN(numero))
                        nome = request.term;
                    else {
                        cpf = request.term;
                        cnpj = request.term;
                    }

                    $.getJSON("/PessoaJuridica/ListarAutoComplete", { Nome: nome, Cpf: cpf, Cnpj: cnpj, Ativo: true }, function (data, status, xhr) {
                        // se não houver pessoa cadastrada, retorna mensagem ao usuário
                        if (data == null || data.Data.length <= 0) {
                            data.Data.push({ Id: 0, Nome: "Pessoa não cadastrada", Cpf: null, Cnpj: null });
                        }
                        response($.map(data.Data, function (pessoa) {
                            if (pessoa.Cpf == null && pessoa.Cnpj == null)
                                return { label: pessoa.Nome, value: pessoa.Id }
                            else if (pessoa.Cpf != null)
                                return { label: pessoa.Nome + " (" + formatarCpf(pessoa.Cpf) + ")", value: pessoa.Id }
                            else if (pessoa.Cnpj != null)
                                return { label: pessoa.Nome + " (" + formatarCnpj(pessoa.Cnpj) + ")", value: pessoa.Id }
                        }));
                    });
                },
                select: function (event, ui) {
                    // apaga a pesquisa do cliente selecionado
                    if (ui.item.label == "Pessoa não cadastrada") {
                        ui.item.label = "";
                        ui.item.value = "";
                        return;
                    }
                    $("#idPromotor").val(ui.item.value);
                    ui.item.label = ui.item.label;
                    ui.item.value = ui.item.label;
                },
                change: function (event, ui) {
                    if (ui == null || ui.item == undefined || ui.item == null) {
                        $("#promotor").val("");
                        $("#idPromotor").val("");
                    }
                }
            });

            $("#veiculo").autocomplete({
                minLength: 3,
                source: function (request, response) {

                    var modelo = null;
                    var placa = null;

                    if (isNaN(parseInt(request.term)))
                        placa = request.term;
                    else
                        placa = request.term;

                    $.getJSON("/Veiculo/ListarAutoComplete", { Modelo: modelo, Placa: placa, Ativo: true }, function (data, status, xhr) {
                        // se não houver veículo cadastrado, retorna mensagem ao usuário
                        if (data == null || data.Data.length <= 0) {
                            data.Data.push({ Id: 0, Descricao: "Veículo não cadastrado" });
                        }
                        response($.map(data.Data, function (veiculo) {
                            if (veiculo.Id == 0)
                                return { label: veiculo.Descricao, value: veiculo.Id }
                            else
                                return { label: veiculo.MontadoraDto.Nome + ' - ' + veiculo.Modelo + ' - ' + veiculo.Placa, value: veiculo.Id }
                        }));
                    });
                },
                select: function (event, ui) {
                    // apaga a pesquisa do veículo selecionado
                    if (ui.item.label == "Veículo não cadastrado") {
                        ui.item.label = "";
                        ui.item.value = "";
                        return;
                    }
                    $("#idVeiculo").val(ui.item.value);
                    ui.item.label = ui.item.label;
                    ui.item.value = ui.item.label;
                },
                change: function (event, ui) {
                    if (ui == null || ui.item == undefined || ui.item == null) {
                        $("#veiculo").val("");
                        $("#idVeiculo").val("");
                    }
                }
            });

            $("#veiculoEntrada").autocomplete({
                minLength: 3,
                source: function (request, response) {

                    var modelo = null;
                    var placa = null;

                    if (isNaN(parseInt(request.term)))
                        placa = request.term;
                    else
                        placa = request.term;

                    $.getJSON("/Veiculo/ListarAutoComplete", { Modelo: modelo, Placa: placa, Ativo: true }, function (data, status, xhr) {
                        // se não houver veículo cadastrado, retorna mensagem ao usuário
                        if (data == null || data.Data.length <= 0) {
                            data.Data.push({ Id: 0, Descricao: "Veículo não cadastrado" });
                        }
                        response($.map(data.Data, function (veiculo) {
                            if (veiculo.Id == 0)
                                return { label: veiculo.Descricao, value: veiculo.Id }
                            else
                                return { label: veiculo.MontadoraDto.Nome + ' - ' + veiculo.Modelo + ' - ' + veiculo.Placa, value: veiculo.Id }
                        }));
                    });
                },
                select: function (event, ui) {
                    // apaga a pesquisa do veículo selecionado
                    if (ui.item.label == "Veículo não cadastrado") {
                        ui.item.label = "";
                        ui.item.value = "";
                        return;
                    }
                    $("#idVeiculoEntrada").val(ui.item.value);
                    ui.item.label = ui.item.label;
                    ui.item.value = ui.item.label;
                },
                change: function (event, ui) {
                    if (ui == null || ui.item == undefined || ui.item == null) {
                        $("#veiculoEntrada").val("");
                        $("#idVeiculoEntrada").val("");
                    }
                }
            });

            $("#btnPesquisar").click(function () {

                var contratoDto = {};

                contratoDto.Id = $("#numeroContratoPesquisar").val();
                contratoDto.IdCliente = $("#idClientePesquisar").val();
                contratoDto.IdProduto = $("#produtoPesquisar").val();

                if ($("#placaPesquisar").val() != "")
                    contratoDto.VeiculoDto = { Placa: $("#placaPesquisar").val() };

                contratoDto.IdSituacaoContrato = $("#situacaoContratoPesquisar").val();
                contratoDto.DataContratoInicial = $("#dataContratoInicioPesquisar").val();
                contratoDto.DataContratoFinal = $("#dataContratoFimPesquisar").val();

                $.ajax({
                    dataType: "json",
                    type: "POST",
                    url: "/Contrato/ListarGrid",
                    data: JSON.stringify(contratoDto),
                    contentType: "application/json",
                    success: function (data) {

                        if (!data.Sucesso) {
                            alert(data.Erro ? "danger" : "warning", data.Mensagem);
                            return;
                        }

                        tbContrato.clear();
                        tbContrato.rows.add(data.Data).draw();

                        tbSituacaoContratoResumo.clear();
                        tbSituacaoContratoResumo.rows.add(data.SituacaoContratoResumo).draw();

                        tbSituacaoParcelaResumo.clear();
                        tbSituacaoParcelaResumo.rows.add(data.SituacaoParcelaResumo).draw();
                    }
                });

            });

            $("#btnNovo").click(function () {
                carregarModalNovo();
            });

            $("#btnIncluir,#btnAlterar").click(function () {

                var contratoDto = {};

                contratoDto.Id = $("#idContrato").val();

                // aba - dados

                contratoDto.DataContrato = $("#dataContrato").val();
                contratoDto.IdCliente = $("#idCliente").val();
                contratoDto.IdProduto = $("#produto").val();
                contratoDto.IdVeiculo = $("#idVeiculo").val();
                contratoDto.IdFiador = $("#idFiador").val();
                contratoDto.IdIndicacao = $("#idIndicacao").val();
                contratoDto.IdPromotor = $("#idPromotor").val();
                contratoDto.IdCanal = $("#canal").val();
                contratoDto.DataPrimeiraParcela = $("#dataPrimeiraParcela").val();
                contratoDto.TaxaMulta = $("#taxaMulta").val();
                contratoDto.TaxaMora = $("#taxaMora").val();

                // aba - valores

                contratoDto.ValorVeiculo = $("#valorVeiculo").val();
                contratoDto.ValorEntrada = $("#valorEntrada").val();
                contratoDto.ValorDocumentacao = $("#valorDocumentacao").val();
                contratoDto.ValorDesconto = $("#valorDesconto").val();
                contratoDto.ValorFinanciadoVeiculo = $("#valorFinanciadoVeiculo").val();
                contratoDto.ValorFinanciadoDocumentacao = $("#valorFinanciadoDocumentacao").val();
                contratoDto.IdVeiculoEntrada = $("#idVeiculoEntrada").val();
                contratoDto.ValorVeiculoEntrada = $("#valorVeiculoEntrada").val();
                contratoDto.ValorDepositado = $("#valorDepositado").val();
                contratoDto.ValorDinheiro = $("#valorDinheiro").val();
                contratoDto.ValorTarifa = $("#valorTarifa").val();

                contratoDto.ValorFinanciado = $("#valorFinanciado").val();
                contratoDto.TaxaJuros = $("#taxaJuros").val();

                // aba - parcelas

                contratoDto.ContratoParcelaDto = [];
                tbContratoParcela.rows().every(function (rowIdx, tableLoop, rowLoop)
                {
                    var data = this.data();

                    contratoDto.ContratoParcelaDto.push
                        ({
                            "NumeroParcela": data.NumeroParcela,
                            "DataInicio": moment(data.DataInicio).format("YYYY/MM/DD"),
                            "DataVencimento": moment(data.DataVencimento).format("YYYY/MM/DD"),
                            "DiasContrato": data.DiasContrato,
                            "DiasParcela": data.DiasParcela,
                            "DataPagamento": moment(data.DataPagamento).format("YYYY/MM/DD"),
                            "DataEmissao": moment(data.DataEmissao).format("YYYY/MM/DD"),
                            "ValorOriginal": data.ValorOriginal,
                            "ValorAmortizacao": data.ValorAmortizacao,
                            "ValorJuros": data.ValorJuros,
                            "ValorMulta": data.ValorMulta,
                            "ValorMora": data.ValorMora,
                            "ValorDesconto": data.ValorDesconto,
                            "ValorParcela": data.ValorParcela,
                            "IdSituacaoParcela": data.SituacaoParcelaDto.Id
                        });
                });

                // aba - histórico

                contratoDto.ContratoHistoricoDto = [];
                tbContratoHistorico.rows().every(function (rowIdx, tableLoop, rowLoop)
                {
                    contratoDto.ContratoHistoricoDto.push
                        ({
                            "Id": this.data().Id,
                            "IdContrato": contratoDto.Id,
                            "DataHistorico": $($($(".dataHistorico")[rowIdx]).parents("tr").children().eq(0)).children().val(),
                            "Descricao": $($($(".descricaoHistorico")[rowIdx]).parents("tr").children().eq(1)).children().val(),
                            "IdUsuarioCadastro": '@usuarioDto.Id',
                            "DataCadastro": '@DateTime.UtcNow'
                        });
                });

                var url = "";
                if (contratoDto.Id == null || contratoDto.Id <= 0)
                {
                    contratoDto.IdSituacaoContrato = '@SituacaoContratoDto.EnumSituacaoContrato.Ativo.GetHashCode()';
                    contratoDto.IdUsuarioCadastro = '@usuarioDto.Id';
                    contratoDto.DataCadastro = '@DateTime.UtcNow';
                    url = "/Contrato/Incluir";
                }
                else
                    url = "/Contrato/Alterar";

                $.ajax({
                    dataType: "json",
                    type: "POST",
                    url: url,
                    data: JSON.stringify(contratoDto),
                    contentType: "application/json",
                    success: function (data) {

                        if (!data.Sucesso) {
                            alert(data.Erro ? "danger" : "warning", data.Mensagem);
                            return;
                        }

                        limparFormulario();

                        var idx;

                        if (contratoDto.Id == null || contratoDto.Id <= 0)
                        {
                            tbContrato.clear();
                            tbContrato.rows.add(data.Data).draw();

                            tbSituacaoContratoResumo.clear();
                            tbSituacaoContratoResumo.rows.add(data.SituacaoContratoResumo).draw();

                            tbSituacaoParcelaResumo.clear();
                            tbSituacaoParcelaResumo.rows.add(data.SituacaoParcelaResumo).draw();
                        }
                        else
                        {
                            $("#tbContrato").DataTable().rows().every(function (rowIdx, tableLoop, rowLoop) {
                                if (this.data().Id == contratoDto.Id) {
                                    idx = rowIdx;
                                    return;
                                }
                            });

                            $("#tbContrato").DataTable().row(idx).invalidate().data(data.Data).draw();
                        }

                        $("#modalContrato").modal('hide');
                    }
                });
            });

            $("#btnAdicionarContratoHistorico").click(function () {

                tbContratoHistorico.rows.add([
                {
                    "Id": 0,
                    "DataHistorico": "<input type='text' class='form-control data datepicker text-center dataHistorico' />",
                    "Descricao": "<textarea class='form-control descricaoHistorico' rows='3'></textarea>",
                    "Acao": "<i class='glyphicon glyphicon-remove' title='Excluir' style='cursor: pointer'></i>"
                }]).draw();

                $(".dataHistorico").mask("00/00/0000");

                $(".dataHistorico").datepicker({
                    dateFormat: 'dd/mm/yy',
                    dayNames: ['Domingo', 'Segunda', 'Terça', 'Quarta', 'Quinta', 'Sexta', 'Sábado'],
                    dayNamesMin: ['D', 'S', 'T', 'Q', 'Q', 'S', 'S', 'D'],
                    dayNamesShort: ['Dom', 'Seg', 'Ter', 'Qua', 'Qui', 'Sex', 'Sáb', 'Dom'],
                    monthNames: ['Janeiro', 'Fevereiro', 'Março', 'Abril', 'Maio', 'Junho', 'Julho', 'Agosto', 'Setembro', 'Outubro', 'Novembro', 'Dezembro'],
                    monthNamesShort: ['Jan', 'Fev', 'Mar', 'Abr', 'Mai', 'Jun', 'Jul', 'Ago', 'Set', 'Out', 'Nov', 'Dez'],
                    nextText: 'Próximo',
                    prevText: 'Anterior',
                    changeMonth: true,
                    changeYear: true
                });
            });

            $("#btnExportar").click(function () {

                var existeRegistroGrid = false;

                tbContrato.rows().every(function (rowIdx, tableLoop, rowLoop) {
                    existeRegistroGrid = true;
                    return;
                });

                if (!existeRegistroGrid) {
                    alert("warning", "Não há registros a serem exportados");
                    return;
                }

                window.location.href = "@Url.Action("Exportar", "Contrato")?Placa=" + $("#placaPesquisar").val() + "&Renavam=" + $("#renavamPesquisar").val() + "&IdProprietarioAtual=" + $("#idProprietarioAtualPesquisar").val() + "&Modelo=" + $("#modeloPesquisar").val();
            });

            $("#btnGerarParcela").click(function () {

                var simulacaoDto = {};

                simulacaoDto.DataInicio = $("#dataContrato").val();
                simulacaoDto.DataPrimeiraParcela = $("#dataPrimeiraParcela").val();
                simulacaoDto.ValorFinanciado = $("#valorFinanciado").val();
                simulacaoDto.QuantidadeParcela = $("#quantidadeParcela").val();
                simulacaoDto.TaxaMensalJuros = $("#taxaJuros").val();

                $.ajax({
                    dataType: "json",
                    type: "POST",
                    url: "/Simulacao/GerarParcelas",
                    data: JSON.stringify(simulacaoDto),
                    contentType: "application/json",
                    success: function (data) {

                        if (!data.Sucesso) {
                            alert(data.Erro ? "danger" : "warning", data.Mensagem);
                            return;
                        }

                        tbContratoParcela.clear();
                        tbContratoParcela.rows.add(data.Data).draw();

                        $('#valorParcela').val(Globalize.format(data.Data[0].ValorParcela, "n2"));
                        $('#parcelas-tab').click();
                    }
                });

            });

            $("#btnAntecipar").click(function () {

                var contratoDto = {};

                contratoDto.Id = $("#contratoIdAntecipar").val();
                contratoDto.DataAntecipacao = $("#dataAntecipacao").val();
                contratoDto.ValorAntecipacao = $("#valorAntecipacao").val();
                contratoDto.IdSituacaoContrato = '@SituacaoContratoDto.EnumSituacaoContrato.Antecipado.GetHashCode()';
                contratoDto.IdUsuarioAntecipacao = '@usuarioDto.Id';

                $.ajax({
                    dataType: "json",
                    type: "POST",
                    url: "/Contrato/Antecipar",
                    data: JSON.stringify(contratoDto),
                    contentType: "application/json",
                    success: function (data) {

                        if (!data.Sucesso) {
                            alert(data.Erro ? "danger" : "warning", data.Mensagem);
                            return;
                        }

                        $("#tbContrato").DataTable().rows().every(function (rowIdx, tableLoop, rowLoop) {
                            if (this.data().Id == contratoDto.Id) {
                                idx = rowIdx;
                                return;
                            }
                        });

                        tbContrato.row(idx).invalidate().data(data.Data[0]).draw();

                        tbSituacaoContratoResumo.clear();
                        tbSituacaoContratoResumo.rows.add(data.SituacaoContratoResumo).draw();

                        tbSituacaoParcelaResumo.clear();
                        tbSituacaoParcelaResumo.rows.add(data.SituacaoParcelaResumo).draw();

                        $("#modalContratoAntecipar").modal('hide');
                    }
                });

            });

            $("#btnBaixar").click(function () {

                var contratoDto = {};

                contratoDto.Id = $("#contratoIdBaixar").val();
                contratoDto.DataBaixa = $("#dataBaixa").val();
                contratoDto.IdSituacaoContrato = '@SituacaoContratoDto.EnumSituacaoContrato.Baixado.GetHashCode()';
                contratoDto.IdUsuarioBaixa = '@usuarioDto.Id';

                $.ajax({
                    dataType: "json",
                    type: "POST",
                    url: "/Contrato/Baixar",
                    data: JSON.stringify(contratoDto),
                    contentType: "application/json",
                    success: function (data) {

                        if (!data.Sucesso) {
                            alert(data.Erro ? "danger" : "warning", data.Mensagem);
                            return;
                        }

                        $("#tbContrato").DataTable().rows().every(function (rowIdx, tableLoop, rowLoop) {
                            if (this.data().Id == contratoDto.Id) {
                                idx = rowIdx;
                                return;
                            }
                        });

                        tbContrato.row(idx).invalidate().data(data.Data[0]).draw();

                        tbSituacaoContratoResumo.clear();
                        tbSituacaoContratoResumo.rows.add(data.SituacaoContratoResumo).draw();

                        tbSituacaoParcelaResumo.clear();
                        tbSituacaoParcelaResumo.rows.add(data.SituacaoParcelaResumo).draw();

                        $("#modalContratoBaixar").modal('hide');
                    }
                });

            });

            document.getElementById('frmContratoImportar').onsubmit = function () {

                var formdata = new FormData();
                var fileInput = document.getElementById('arquivo');

                var existeArquivo = fileInput.files[0] != undefined ? true : false;

                if (!existeArquivo) {
                    alert("warning","Selecione um arquivo para importar");
                    return false;
                }

                $.blockUI({ message: '<h5>Carregando...</h4>' });

                formdata.append(fileInput.files[0].name, fileInput.files[0]);

                var xhr = new XMLHttpRequest();

                xhr.open('POST', '/Contrato/Importar');
                xhr.send(formdata);

                xhr.onreadystatechange = function () {
                    if (xhr.readyState == 4 && xhr.status == 200)
                    {
                        var response = JSON.parse(xhr.responseText);
                        $.unblockUI();
                        alert("info", response.Mensagem);
                    }
                }

                return false;
            }

            $('#consultaPesquisa-tab').click();

            var simulacaoDto = @Html.Raw(Json.Encode(ViewBag.SimulacaoDto));

            if (simulacaoDto != null)
            {
                carregarModalNovo();

                $("#dataContrato").val(moment(simulacaoDto.DataInicio).format("DD/MM/YYYY"));
                $("#valorVeiculo").val(Globalize.format(simulacaoDto.ValorPrincipal, "n2"));
                $("#dataPrimeiraParcela").val(moment(simulacaoDto.DataPrimeiraParcela).format("DD/MM/YYYY"));
                $("#quantidadeParcela").val(simulacaoDto.QuantidadeParcela);
                $("#taxaJuros").val(Globalize.format(simulacaoDto.TaxaMensalJuros, "n2"));
                $("#valorFinanciado").val(Globalize.format(simulacaoDto.ValorFinanciado, "n2"));

                if (simulacaoDto.ValorDocumentacao != 0)
                    $("#valorDocumentacao").val(Globalize.format(simulacaoDto.ValorDocumentacao, "n2"));

                if (simulacaoDto.ValorTarifa != 0)
                    $("#valorTarifa").val(Globalize.format(simulacaoDto.ValorTarifa, "n2"));

                if (simulacaoDto.ValorDesconto != 0)
                    $("#valorDesconto").val(Globalize.format(simulacaoDto.ValorDesconto, "n2"));

                if (simulacaoDto.ValorBens != 0)
                    $("#valorVeiculoEntrada").val(Globalize.format(simulacaoDto.ValorBens, "n2"));

                if (simulacaoDto.ValorDinheiro != 0)
                    $("#valorDinheiro").val(Globalize.format(simulacaoDto.ValorDinheiro, "n2"));

                if (simulacaoDto.ContratoParcelaDto != null && simulacaoDto.ContratoParcelaDto.length > 0)
                    $("#valorParcela").val(Globalize.format(simulacaoDto.ContratoParcelaDto[0].ValorParcela, "n2"));

                tbContratoParcela.clear();
                tbContratoParcela.rows.add(simulacaoDto.ContratoParcelaDto).draw();
            }
        });

    </script>
}
<div>
    <h2><i class="glyphicon glyphicon-list-alt" style="color: #0f3456" title="Contratos"></i> Contratos</h2>
    <hr />
    <input id="idContrato" type="hidden" />
    <div class="form-group">
        <div class="row">
            <div class="col-md-2">
                <label for="numeroContratoPesquisar">Número Contrato:</label>
                <input id="numeroContratoPesquisar" type="text" class="form-control" />
            </div>
            <div class="col-md-3">
                <label for="clientePesquisar">Cliente:</label>
                <input id="clientePesquisar" type="text" class="form-control" placeholder="Cliente (Mínimo de 3 caracteres - CPF ou CNPJ ou Nome)" />
                <input id="idClientePesquisar" type="hidden" />
            </div>
            <div class="col-md-2">
                <label for="situacaoContratoPesquisar">Situação Contrato:</label>
                @Html.DropDownList("situacaoContratoPesquisar", new SelectList(ViewBag.SituacaoContrato, "Id", "Nome"), "Selecione", new { @class = "form-control" })
            </div>
            <div class="col-md-2">
                <label for="placaPesquisar">Placa:</label>
                <input id="placaPesquisar" type="text" class="form-control" />
            </div>
            <div class="col-md-2">
                <label for="produtoPesquisar">Produto:</label>
                @Html.DropDownList("produtoPesquisar", new SelectList(ViewBag.Produto, "Id", "Nome"), "Selecione", new { @class = "form-control" })
            </div>
        </div>
    </div>
    <div class="form-group">
        <div class="row">
            <div class="col-md-2">
                <label>Data Contrato Início:</label>
                <input id="dataContratoInicioPesquisar" type="text" class="form-control data datepicker" />
            </div>
            <div class="col-md-2">
                <label>Data Contrato Fim:</label>
                <input id="dataContratoFimPesquisar" type="text" class="form-control data datepicker" />
            </div>
        </div>
    </div>
    <div class="form-group">
        <div class="row">
            <div class="col-md-3">
                <input id="btnPesquisar" type="button" class="btn btn-info" value="Pesquisar" />
                <input id="btnNovo" type="button" class="btn" value="Novo Contrato" />
            </div>
        </div>
    </div>
    <div class="form-group">
        <div class="row">
            <div class="col-md-12">
                <input id="btnExportar" type="button" class="btn btn-success" value="Exportar" />
                <form id="frmContratoImportar" style="display: inline-flex">
                    <input id="arquivo" name="arquivo" type="file" />
                    <input id="btnImportar" type="submit" class="btn btn-warning" value="Importar" />
                </form>
            </div>
        </div>
    </div>
    <div class="form-group">
        <ul id="myTab2" class="nav nav-tabs nav-justified" role="tablist">
            <li class="nav-item">
                <a class="nav-link active" id="consultaPesquisa-tab" data-toggle="tab" href="#consultaPesquisa" role="tab" aria-controls="consultaPesquisa" aria-selected="true">Consulta</a>
            </li>
            <li class="nav-item">
                <a class="nav-link" id="situacaoContratoResumo-tab" data-toggle="tab" href="#situacaoContratoResumo" role="tab" aria-controls="situacaoContratoResumo" aria-selected="false">Resumo (Situação Contrato)</a>
            </li>
            <li class="nav-item">
                <a class="nav-link" id="situacaoParcelaResumo-tab" data-toggle="tab" href="#situacaoParcelaResumo" role="tab" aria-controls="situacaoParcelaResumo" aria-selected="false">Resumo (Situação Parcela)</a>
            </li>
        </ul>
        <div class="tab-content">
            <div class="tab-pane active" id="consultaPesquisa" role="tabpanel" aria-labelledby="consultaPesquisa-tab">
                <div class="table-responsive">
                    <table id="tbContrato" class="table table-hover nowrap">
                        <thead>
                            <tr>
                                <td class="text-center" style="width: 10%"><b>Número Contrato</b></td>
                                <td class="text-center" style="width: 15%"><b>Cliente</b></td>
                                <td class="text-center" style="width: 15%"><b>Placa</b></td>
                                <td class="text-center" style="width: 15%"><b>Modelo</b></td>
                                <td class="text-center" style="width: 15%"><b>Data Contrato</b></td>
                                <td class="text-center" style="width: 15%"><b>Valor Financiado</b></td>
                                <td class="text-center" style="width: 15%"><b>Situação Contrato</b></td>
                                <td class="text-center" style="width: 5%"><b>Ação</b></td>
                            </tr>
                        </thead>
                        <tbody></tbody>
                    </table>
                </div>
            </div>
            <div class="tab-pane" id="situacaoContratoResumo" role="tabpanel" aria-labelledby="situacaoContratoResumo-tab">
                <div class="table-responsive">
                    <table id="tbSituacaoContratoResumo" class="table table-hover nowrap">
                        <thead>
                            <tr>
                                <td class="text-center" style="width: 15%"><b>Situação Contrato</b></td>
                                <td class="text-center" style="width: 15%"><b>Produto</b></td>
                                <td class="text-center" style="width: 15%"><b>Quantidade</b></td>
                                <td class="text-center" style="width: 15%"><b>Total Valor Entrada</b></td>
                                <td class="text-center" style="width: 15%"><b>Total Valor Financiado</b></td>
                            </tr>
                        </thead>
                        <tbody></tbody>
                    </table>
                </div>
            </div>
            <div class="tab-pane" id="situacaoParcelaResumo" role="tabpanel" aria-labelledby="situacaoParcelaResumo-tab">
                <div class="table-responsive">
                    <table id="tbSituacaoParcelaResumo" class="table table-hover nowrap">
                        <thead>
                            <tr>
                                <td class="text-center" style="width: 15%"><b>Situação Parcela</b></td>
                                <td class="text-center" style="width: 15%"><b>Quantidade</b></td>
                                <td class="text-center" style="width: 15%"><b>Total Valor Juros</b></td>
                                <td class="text-center" style="width: 15%"><b>Total Valor Parcela</b></td>
                            </tr>
                        </thead>
                        <tbody></tbody>
                    </table>
                </div>
            </div>
        </div>
    </div>
</div>

<div class="modal fade" id="modalContratoBaixar" tabindex="-1" role="dialog" aria-labelledby="ModalContratoBaixar" aria-hidden="true">
    <div class="modal-dialog">
        <div class="modal-content">
            <div class="modal-header">
                <button type="button" class="close" data-dismiss="modal"><span aria-hidden="true">&times;</span><span class="sr-only">Fechar</span></button>
                <h4 class="modal-title" id="myModalLabel">Baixar Contrato <label id="lblTituloBaixar"></label></h4>
            </div>
            <div class="modal-body">
                <input id="contratoIdBaixar" type="hidden" />
                <div class="form-group">
                    <div class="row">
                        <div class="col-md-4">
                            <label for="dataBaixa">Data Baixa:</label>
                            <input id="dataBaixa" type="text" class="form-control data datepicker" />
                        </div>
                    </div>
                </div>
            </div>
            <div class="modal-footer">
                <input id="btnBaixar" type="button" class="btn btn-primary" value="Baixar" />
            </div>
        </div>
    </div>
</div>

<div class="modal fade" id="modalContratoAntecipar" tabindex="-1" role="dialog" aria-labelledby="ModalContratoAntecipar" aria-hidden="true">
    <div class="modal-dialog modal-lg">
        <div class="modal-content">
            <div class="modal-header">
                <button type="button" class="close" data-dismiss="modal"><span aria-hidden="true">&times;</span><span class="sr-only">Fechar</span></button>
                <h4 class="modal-title" id="myModalLabel">Antecipar Contrato <label id="lblTituloAntecipar"></label></h4>
            </div>
            <div class="modal-body">
                <input id="contratoIdAntecipar" type="hidden" />
                <div class="form-group">
                    <div class="row">
                        <div class="col-md-4">
                            <label for="dataAntecipacao">Data Antecipação:</label>
                            <input id="dataAntecipacao" type="text" class="form-control data datepicker" />
                        </div>
                        <div class="col-md-4">
                            <label for="valorSaldoAntecipacao">Valor Saldo Antecipação:</label>
                            <input id="valorSaldoAntecipacao" type="text" class="form-control valor" disabled="disabled" />
                        </div>
                        <div class="col-md-4">
                            <label for="valorAntecipacao">Valor Antecipação:</label>
                            <input id="valorAntecipacao" type="text" class="form-control valor" />
                        </div>
                    </div>
                </div>
            </div>
            <div class="modal-footer">
                <input id="btnAntecipar" type="button" class="btn btn-primary" value="Antecipar" />
            </div>
        </div>
    </div>
</div>

<div class="modal fade" id="modalContrato" tabindex="-1" role="dialog" aria-labelledby="ModalContrato" aria-hidden="true">
    <div class="modal-dialog modal-lg">
        <div class="modal-content">
            <div class="modal-header">
                <button type="button" class="close" data-dismiss="modal"><span aria-hidden="true">&times;</span><span class="sr-only">Fechar</span></button>
                <h4 class="modal-title" id="myModalLabel"><span id="lblAcao"></span> Contrato <label id="lblTitulo"></label></h4>
            </div>
            <div class="modal-body">
                <form id="frmContrato" action="#">
                    <input id="idContrato" type="hidden" />
                    <div class="form-group">
                        <div class="row">
                            <ul id="myTab" class="nav nav-tabs nav-justified" role="tablist">
                                <li class="nav-item">
                                    <a class="nav-link active" id="dados-tab" data-toggle="tab" href="#dados" role="tab" aria-controls="dados" aria-selected="true">Dados</a>
                                </li>
                                <li class="nav-item">
                                    <a class="nav-link" id="valores-tab" data-toggle="tab" href="#valores" role="tab" aria-controls="valores" aria-selected="false">Valores</a>
                                </li>
                                <li class="nav-item">
                                    <a class="nav-link" id="parcelas-tab" data-toggle="tab" href="#parcelas" role="tab" aria-controls="parcelas" aria-selected="false">Parcelas</a>
                                </li>
                                <li class="nav-item">
                                    <a class="nav-link" id="historico-tab" data-toggle="tab" href="#historico" role="tab" aria-controls="historico" aria-selected="false">Histórico</a>
                                </li>
                            </ul>
                            <div class="tab-content">
                                <br />
                                <div class="tab-pane active" id="dados" role="tabpanel" aria-labelledby="dados-tab">
                                    <div class="form-group">
                                        <div class="row">
                                            <div class="col-md-2">
                                                <label for="dataContrato">Data Contrato:</label>
                                                <input id="dataContrato" type="text" class="form-control data datepicker" />
                                            </div>
                                            <div class="col-md-3">
                                                <label class="control-label" for="cliente">Cliente:</label>
                                                <div class="input-group">
                                                    <input id="cliente" type="text" class="form-control" placeholder="Cliente (Mínimo de 3 caracteres - CPF ou CNPJ ou Nome)" />
                                                    <input id="idCliente" type="hidden" />
                                                    <div class="input-group-addon" style="cursor: pointer" data-id="idCliente" data-nome="cliente" data-titulo="Cliente" data-sem-vinculo="false" data-documento="Cpf/Cnpj" onclick="abrirModalPessoaCadastroAuxiliar(this)">+</div>
                                                </div>
                                            </div>
                                            <div class="col-md-2">
                                                <label for="produto">Produto:</label>
                                                @Html.DropDownList("produto", new SelectList(ViewBag.Produto, "Id", "Nome"), "Selecione", new { @class = "form-control" })
                                            </div>
                                            <div class="col-md-3">
                                                <label for="veiculo">Veículo:</label>
                                                <input id="veiculo" type="text" class="form-control" placeholder="Veículo (Mínimo de 3 caracteres - Placa)" />
                                                <input id="idVeiculo" type="hidden" />
                                            </div>
                                        </div>
                                    </div>
                                    <div class="form-group">
                                        <div class="row">
                                            <div class="col-md-3">
                                                <label class="control-label" for="fiador">Fiador:</label>
                                                <div class="input-group">
                                                    <input id="fiador" type="text" class="form-control" placeholder="Fiador (Mínimo de 3 caracteres - CPF ou CNPJ ou Nome)" />
                                                    <input id="idFiador" type="hidden" />
                                                    <div class="input-group-addon" style="cursor: pointer" data-id="idFiador" data-nome="fiador" data-titulo="Fiador" data-sem-vinculo="false" data-documento="Cpf/Cnpj" onclick="abrirModalPessoaCadastroAuxiliar(this)">+</div>
                                                </div>
                                            </div>
                                            <div class="col-md-3">
                                                <label class="control-label" for="indicacao">Indicação:</label>
                                                <div class="input-group">
                                                    <input id="indicacao" type="text" class="form-control" placeholder="Indicação (Mínimo de 3 caracteres - CPF ou CNPJ ou Nome)" />
                                                    <input id="idIndicacao" type="hidden" />
                                                    <div class="input-group-addon" style="cursor: pointer" data-id="idIndicacao" data-nome="indicacao" data-titulo="Indicação" data-sem-vinculo="false" data-documento="Cpf/Cnpj" onclick="abrirModalPessoaCadastroAuxiliar(this)">+</div>
                                                </div>
                                            </div>
                                            <div class="col-md-3">
                                                <label class="control-label" for="promotor">Promotor:</label>
                                                <div class="input-group">
                                                    <input id="promotor" type="text" class="form-control" placeholder="Promotor (Mínimo de 3 caracteres - CPF ou CNPJ ou Nome)" />
                                                    <input id="idPromotor" type="hidden" />
                                                    <div class="input-group-addon" style="cursor: pointer" data-id="idPromotor" data-nome="promotor" data-titulo="Promotor" data-sem-vinculo="false" data-documento="Cpf/Cnpj" onclick="abrirModalPessoaCadastroAuxiliar(this)">+</div>
                                                </div>
                                            </div>
                                            <div class="col-md-3">
                                                <label for="canal">Canal:</label>
                                                @Html.DropDownList("canal", new SelectList(ViewBag.Canal, "Id", "Nome"), "Selecione", new { @class = "form-control" })
                                            </div>
                                        </div>
                                    </div>
                                    <div class="form-group">
                                        <div class="row">
                                            <div class="col-md-2">
                                                <label for="dataPrimeiraParcela">Data Primeira Parcela:</label>
                                                <input id="dataPrimeiraParcela" type="text" class="form-control data datepicker" />
                                            </div>
                                            <div class="col-md-2">
                                                <label for="valorParcela">Valor Parcela:</label>
                                                <input id="valorParcela" type="text" class="form-control valor" />
                                            </div>
                                            <div class="col-md-2">
                                                <label for="taxaMulta">Taxa Multa:</label>
                                                <input id="taxaMulta" type="text" class="form-control" disabled="disabled" />
                                            </div>
                                            <div class="col-md-2">
                                                <label for="taxaMora">Taxa Mora:</label>
                                                <input id="taxaMora" type="text" class="form-control" disabled="disabled" />
                                            </div>
                                        </div>
                                    </div>
                                    <div class="form-group">
                                        <div class="row">
                                            <div class="col-md-2" id="divDataAntecipacaoDados">
                                                <label for="dataAntecipacaoDados">Data Antecipação:</label>
                                                <input id="dataAntecipacaoDados" type="text" class="form-control" disabled="disabled" />
                                            </div>
                                            <div class="col-md-2" id="divValorAntecipacaoDados">
                                                <label for="valorAntecipacaoDados">Valor Antecipação:</label>
                                                <input id="valorAntecipacaoDados" type="text" class="form-control" disabled="disabled" />
                                            </div>
                                        </div>
                                    </div>
                                    <div class="form-group">
                                        <div class="row">
                                            <div class="col-md-2" id="divDataBaixaDados">
                                                <label for="dataBaixaDados">Data Baixa:</label>
                                                <input id="dataBaixaDados" type="text" class="form-control" disabled="disabled" />
                                            </div>
                                        </div>
                                    </div>
                                </div>
                                <div class="tab-pane" id="valores" role="tabpanel" aria-labelledby="valores-tab">
                                    <div class="form-group">
                                        <div class="row">
                                            <div class="col-md-2">
                                                <label for="valorVeiculo">Valor Veículo:</label>
                                                <input id="valorVeiculo" type="text" class="form-control valor" onchange="calcularValorFinanciado()" />
                                            </div>
                                            <div class="col-md-2">
                                                <label for="valorEntrada">Valor Entrada:</label>
                                                <input id="valorEntrada" type="text" class="form-control valor" onchange="calcularValorFinanciado()" />
                                            </div>
                                            <div class="col-md-2">
                                                <label for="valorDocumentacao">Valor Documentação:</label>
                                                <input id="valorDocumentacao" type="text" class="form-control valor" onchange="calcularValorFinanciado()" />
                                            </div>
                                            <div class="col-md-2">
                                                <label for="valorDesconto">Valor Desconto:</label>
                                                <input id="valorDesconto" type="text" class="form-control valor" onchange="calcularValorFinanciado()" />
                                            </div>
                                            <div class="col-md-2">
                                                <label for="valorDinheiro">Valor Dinheiro:</label>
                                                <input id="valorDinheiro" type="text" class="form-control valor" onchange="calcularValorFinanciado()" />
                                            </div>

                                        </div>
                                    </div>
                                    <div class="form-group">
                                        <div class="row">
                                            <div class="col-md-4">
                                                <label for="veiculoEntrada">Veículo Entrada:</label>
                                                <input id="veiculoEntrada" type="text" class="form-control" placeholder="Veículo Entrada (Mínimo de 3 caracteres - Placa)" />
                                                <input id="idVeiculoEntrada" type="hidden" />
                                            </div>
                                            <div class="col-md-2">
                                                <label for="valorVeiculoEntrada">Valor Veículo Entrada:</label>
                                                <input id="valorVeiculoEntrada" type="text" class="form-control valor" onchange="calcularValorFinanciado()" />
                                            </div>
                                            <div class="col-md-2">
                                                <label for="valorDepositado">Valor Depositado:</label>
                                                <input id="valorDepositado" type="text" class="form-control valor" onchange="calcularValorFinanciado()" />
                                            </div>
                                            <div class="col-md-2">
                                                <label for="valorTarifa">Valor Tarifa:</label>
                                                <input id="valorTarifa" type="text" class="form-control valor" onchange="calcularValorFinanciado()" />
                                            </div>
                                        </div>
                                    </div>
                                    <div class="form-group">
                                        <div class="row">
                                            <div class="col-md-2">
                                                <label for="valorFinanciado">Valor Financiado Total:</label>
                                                <input id="valorFinanciado" type="text" class="form-control valor" disabled="disabled" />
                                            </div>
                                            <div class="col-md-2">
                                                <label for="taxaJuros">Taxa Juros:</label>
                                                <input id="taxaJuros" type="text" class="form-control taxa" />
                                            </div>
                                            <div class="col-md-2">
                                                <label for="quantidadeParcela">Quantidade Parcelas:</label>
                                                <input id="quantidadeParcela" type="text" class="form-control parcela" />
                                            </div>
                                        </div>
                                    </div>
                                    <div class="form-group">
                                        <div class="row">
                                            <div class="col-md-2">
                                                <label for="valorFinanciadoDocumentacao">Valor Financiado Documentação:</label>
                                                <input id="valorFinanciadoDocumentacao" type="text" class="form-control valor" />
                                            </div>
                                            <div class="col-md-2">
                                                <label for="valorFinanciadoVeiculo">Valor Financiado Veículo:</label>
                                                <input id="valorFinanciadoVeiculo" type="text" class="form-control valor" />
                                            </div>
                                        </div>
                                    </div>
                                    <div class="form-group">
                                        <div class="row">
                                            <div class="col-md-12 text-right">
                                                <input id="btnGerarParcela" type="button" class="btn btn-info" value="Gerar Parcelas" />
                                            </div>
                                        </div>
                                    </div>
                                </div>
                                <div class="tab-pane" id="parcelas" role="tabpanel" aria-labelledby="parcelas-tab">
                                    <div class="form-group">
                                        <div class="table-responsive" style="overflow-x: hidden; overflow-y: scroll; height: 350px">
                                            <table id="tbContratoParcela" class="table table-hover nowrap" style="width: 100%">
                                                <thead>
                                                    <tr>
                                                        <td class="text-center"><b>Parcela</b></td>
                                                        <td class="text-center"><b>Data Início</b></td>
                                                        <td class="text-center"><b>Data Vencimento</b></td>
                                                        <td class="text-center"><b>Dias Contrato</b></td>
                                                        <td class="text-center"><b>Dias Parcela</b></td>
                                                        <td class="text-center"><b>Data Pagamento</b></td>
                                                        <td class="text-center"><b>Data Emissão</b></td>
                                                        <td class="text-center"><b>Valor Original</b></td>
                                                        <td class="text-center"><b>Valor Amortização</b></td>
                                                        <td class="text-center"><b>Valor Juros</b></td>
                                                        <td class="text-center"><b>Valor Multa</b></td>
                                                        <td class="text-center"><b>Valor Mora</b></td>
                                                        <td class="text-center"><b>Valor Desconto</b></td>
                                                        <td class="text-center"><b>Valor Parcela</b></td>
                                                        <td class="text-center"><b>Situação</b></td>
                                                    </tr>
                                                </thead>
                                                <tbody></tbody>
                                            </table>
                                        </div>
                                    </div>
                                </div>
                                <div class="tab-pane" id="valores" role="tabpanel" aria-labelledby="valores-tab">
                                    <div class="form-group">
                                        <div class="row">
                                            <div class="col-md-2">
                                                <label for="dataAquisicao">Data Aquisição:</label>
                                                <input id="dataAquisicao" name="dataAquisicao" type="text" class="form-control data datepicker" placeholder="Data Aquisição" />
                                            </div>
                                            <div class="col-md-2">
                                                <label for="valorAquisicao">Valor Aquisição:</label>
                                                <input id="valorAquisicao" name="valorAquisicao" type="text" class="form-control valor" placeholder="Valor Aquisição" />
                                            </div>
                                        </div>
                                    </div>
                                    <div class="form-group">
                                        <div class="row">
                                            <div class="col-md-2">
                                                <label for="dataVenda">Data Venda:</label>
                                                <input id="dataVenda" name="dataVenda" type="text" class="form-control data datepicker" placeholder="Data Venda" />
                                            </div>
                                            <div class="col-md-2">
                                                <label for="valorVenda">Valor Venda:</label>
                                                <input id="valorVenda" name="valorVenda" type="text" class="form-control valor" placeholder="Valor Venda" />
                                            </div>
                                        </div>
                                    </div>
                                    <div class="form-group">
                                        <div class="row">
                                            <div class="col-md-2">
                                                <label for="dataRecuperacao">Data Recuperação:</label>
                                                <input id="dataRecuperacao" name="dataRecuperacao" type="text" class="form-control data datepicker" placeholder="Data Recuperação" />
                                            </div>
                                            <div class="col-md-2">
                                                <label for="valorTransportadora">Valor Transportadora:</label>
                                                <input id="valorTransportadora" name="valorTransportadora" type="text" class="form-control valor" placeholder="Valor Transportadora" />
                                            </div>
                                        </div>
                                    </div>
                                    <div class="form-group">
                                        <div class="row">
                                            <div class="col-md-2">
                                                <label for="dataValorFIPE">Data Valor FIPE:</label>
                                                <input id="dataValorFIPE" name="dataValorFIPE" type="text" class="form-control data datepicker" placeholder="Data Valor FIPE" />
                                            </div>
                                            <div class="col-md-2">
                                                <label for="valorFIPE">Valor FIPE:</label>
                                                <input id="valorFIPE" name="valorFIPE" type="text" class="form-control valor" placeholder="Valor FIPE" />
                                            </div>
                                        </div>
                                    </div>
                                </div>
                                <div class="tab-pane" id="historico" role="tabpanel" aria-labelledby="historico-tab">
                                    <div class="form-group">
                                        <div class="row">
                                            <div class="col-md-12 text-right">
                                                <input id="btnAdicionarContratoHistorico" type="button" class="btn" value="Adicionar Histórico" />
                                            </div>
                                        </div>
                                    </div>
                                    <div class="form-group">
                                        <div class="table-responsive">
                                            <table id="tbContratoHistorico" class="table nowrap" style="width: 100%">
                                                <thead>
                                                    <tr>
                                                        <td class="text-center"><b>Id</b></td>
                                                        <td class="text-center"><b>Data Histórico</b></td>
                                                        <td class="text-center"><b>Descrição</b></td>
                                                        <td class="text-center"><b>Ação</b></td>
                                                    </tr>
                                                </thead>
                                                <tbody></tbody>
                                            </table>
                                        </div>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                </form>
            </div>
            <div class="modal-footer">
                <input id="btnIncluir" type="button" class="btn btn-primary" value="Incluir" />
                <input id="btnAlterar" type="button" class="btn btn-warning" value="Alterar" />
            </div>
        </div>
    </div>
</div>

@Html.Partial("_PessoaCadastroAuxiliar")